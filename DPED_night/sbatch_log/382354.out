WARNING:tensorflow:From /itet-stor/ollehman/net_scratch/conda_envs/tencu10/lib/python3.7/site-packages/tensorflow_core/python/compat/v2_compat.py:68: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term

The following parameters will be applied for CNN training:

Batch size: 32
Train size: 5000
Learning rate: 1e-05
Training iterations: 80000
Restore iteration at: 50000

Loss: dped_night
Path to DPED dataset: ../../crops/
Path to VGG-19 network: vgg_pretrained/imagenet-vgg-verydeep-19.mat
Evaluation step: 1000
Run Id: dped_night_loss_50000
Input Images: 3

2021-06-20 16:39:42.174441: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-20 16:39:42.273820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:83:00.0
2021-06-20 16:39:42.276716: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-06-20 16:39:42.280579: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-06-20 16:39:42.284762: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-06-20 16:39:42.287620: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-06-20 16:39:42.292509: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-06-20 16:39:42.296585: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-06-20 16:39:42.304645: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-06-20 16:39:42.317835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2021-06-20 16:39:42.319437: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2021-06-20 16:39:42.348007: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2199990000 Hz
2021-06-20 16:39:42.349645: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564cf148cf40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-20 16:39:42.350670: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-06-20 16:39:42.357415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:83:00.0
2021-06-20 16:39:42.358662: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-06-20 16:39:42.359919: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-06-20 16:39:42.361137: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-06-20 16:39:42.362218: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-06-20 16:39:42.363214: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-06-20 16:39:42.364256: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-06-20 16:39:42.365330: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-06-20 16:39:42.375682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2021-06-20 16:39:42.376915: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-06-20 16:39:42.594277: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-20 16:39:42.595268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-06-20 16:39:42.596152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-06-20 16:39:42.603404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11437 MB memory) -> physical GPU (device: 0, name: TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
2021-06-20 16:39:42.606664: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564cf2304f30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-06-20 16:39:42.607596: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): TITAN Xp, Compute Capability 6.1
WARNING:tensorflow:From /srv/beegfs02/scratch/hdr_night/data/hdr_night/DPED_night/vgg.py:49: The name tf.nn.max_pool is deprecated. Please use tf.nn.max_pool2d instead.

WARNING:tensorflow:From /itet-stor/ollehman/net_scratch/conda_envs/tencu10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
Restoring Variables from: dped_night_loss_50000/iteration_50000
Initializing variables
Loading validation data...
Validation data was loaded

Loading training data...
Training data was loaded

Training network
2021-06-20 16:56:26.548854: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-06-20 16:56:27.777184: W tensorflow/stream_executor/cuda/redzone_allocator.cc:312] Not found: ./bin/ptxas not found
Relying on driver to perform ptx compilation. This message will be only logged once.
2021-06-20 16:56:27.884157: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-06-20 16:56:29.245909: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.27GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-20 16:56:29.607049: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 601.00MiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-20 16:56:30.102755: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.28GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-20 16:56:30.174304: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.28GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-20 16:56:30.260366: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.28GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-20 16:56:31.144619: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.27GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
step 51000 generator losses | train: 103.7, val: 96.74 | content: 9.022, color: 2930, tv: 0.0003811 | psnr: 14.86, ms-ssim: 0.8212

current train/eval time: 0:33:30.369679
step 52000 generator losses | train: 94.96, val: 92.56 | content: 8.661, color: 2302, tv: 0.0004947 | psnr: 15.89, ms-ssim: 0.8371

current train/eval time: 1:01:22.650742
step 53000 generator losses | train: 91.28, val: 90.26 | content: 8.473, color: 1849, tv: 0.0005601 | psnr: 16.79, ms-ssim: 0.8486

current train/eval time: 1:29:13.457004
step 54000 generator losses | train: 87.58, val: 88.66 | content: 8.342, color: 1536, tv: 0.0006505 | psnr: 17.54, ms-ssim: 0.8557

current train/eval time: 1:57:15.755424
step 55000 generator losses | train: 87.05, val: 87.24 | content: 8.224, color: 1327, tv: 0.0006799 | psnr: 18.13, ms-ssim: 0.8605

current train/eval time: 2:24:44.794723
step 56000 generator losses | train: 84.77, val: 85.03 | content: 8.017, color: 1159, tv: 0.000717 | psnr: 18.65, ms-ssim: 0.8677

current train/eval time: 2:52:14.559028
step 57000 generator losses | train: 85.03, val: 83.14 | content: 7.848, color: 1041, tv: 0.0007329 | psnr: 19.08, ms-ssim: 0.8703

current train/eval time: 3:19:53.389821
step 58000 generator losses | train: 82.5, val: 82.28 | content: 7.778, color: 923.9, tv: 0.0007531 | psnr: 19.54, ms-ssim: 0.8744

current train/eval time: 3:47:31.487776
step 59000 generator losses | train: 81.13, val: 80.89 | content: 7.653, color: 850.5, tv: 0.0007873 | psnr: 19.87, ms-ssim: 0.879

current train/eval time: 4:15:05.768469
step 60000 generator losses | train: 81.13, val: 80.3 | content: 7.6, color: 810.9, tv: 0.0008215 | psnr: 20.05, ms-ssim: 0.8802

current train/eval time: 4:42:46.716278
step 61000 generator losses | train: 79.03, val: 79.66 | content: 7.539, color: 777.4, tv: 0.0008193 | psnr: 20.19, ms-ssim: 0.8799

current train/eval time: 5:11:15.163488
step 62000 generator losses | train: 79.01, val: 79.12 | content: 7.497, color: 737.7, tv: 0.0008642 | psnr: 20.4, ms-ssim: 0.8814

current train/eval time: 5:38:37.253308
step 63000 generator losses | train: 80.47, val: 78.83 | content: 7.469, color: 718.2, tv: 0.0008665 | psnr: 20.49, ms-ssim: 0.8828

current train/eval time: 6:04:59.901570
step 64000 generator losses | train: 78.23, val: 78.39 | content: 7.45, color: 677.5, tv: 0.0008932 | psnr: 20.77, ms-ssim: 0.8877

current train/eval time: 6:31:10.149179
step 65000 generator losses | train: 77.23, val: 77.66 | content: 7.368, color: 671.4, tv: 0.0008909 | psnr: 20.75, ms-ssim: 0.8871

current train/eval time: 6:57:35.568040
step 66000 generator losses | train: 77.65, val: 77.63 | content: 7.385, color: 648.8, tv: 0.0008971 | psnr: 20.92, ms-ssim: 0.8886

current train/eval time: 7:23:46.272837
step 67000 generator losses | train: 76.93, val: 77.39 | content: 7.358, color: 635.6, tv: 0.0008863 | psnr: 20.97, ms-ssim: 0.8881

current train/eval time: 7:50:05.744648
step 68000 generator losses | train: 77.57, val: 76.85 | content: 7.306, color: 631.5, tv: 0.0009343 | psnr: 21, ms-ssim: 0.8885

current train/eval time: 8:16:23.775590
step 69000 generator losses | train: 76.57, val: 76.5 | content: 7.279, color: 622.2, tv: 0.0008967 | psnr: 21.07, ms-ssim: 0.8903

current train/eval time: 8:42:43.112424
step 70000 generator losses | train: 77.04, val: 76.42 | content: 7.272, color: 614.5, tv: 0.0009143 | psnr: 21.1, ms-ssim: 0.8905

current train/eval time: 9:09:12.329789
step 71000 generator losses | train: 76.05, val: 76.01 | content: 7.232, color: 606.1, tv: 0.00093 | psnr: 21.18, ms-ssim: 0.8911

current train/eval time: 9:35:41.817730
step 72000 generator losses | train: 75.22, val: 75.93 | content: 7.229, color: 587.7, tv: 0.0009812 | psnr: 21.28, ms-ssim: 0.8942

current train/eval time: 10:01:44.725566
step 73000 generator losses | train: 74.68, val: 75.99 | content: 7.23, color: 601.2, tv: 0.0009412 | psnr: 21.17, ms-ssim: 0.8916

current train/eval time: 10:27:29.812036
step 74000 generator losses | train: 75.35, val: 75.43 | content: 7.167, color: 606.5, tv: 0.0009434 | psnr: 21.12, ms-ssim: 0.8922

current train/eval time: 10:53:16.914029
step 75000 generator losses | train: 75.15, val: 75.69 | content: 7.207, color: 588.2, tv: 0.001004 | psnr: 21.28, ms-ssim: 0.8935

current train/eval time: 11:19:16.535727
step 76000 generator losses | train: 74.96, val: 75.34 | content: 7.157, color: 615.8, tv: 0.0009623 | psnr: 21.06, ms-ssim: 0.8908

current train/eval time: 11:45:30.806895
step 77000 generator losses | train: 74.96, val: 75.25 | content: 7.145, color: 622.1, tv: 0.0009603 | psnr: 21.02, ms-ssim: 0.8871

current train/eval time: 12:11:25.397614
step 78000 generator losses | train: 75.04, val: 74.83 | content: 7.126, color: 576.3, tv: 0.0009693 | psnr: 21.36, ms-ssim: 0.8948

current train/eval time: 12:37:27.614410
step 79000 generator losses | train: 74.13, val: 74.7 | content: 7.104, color: 588.7, tv: 0.000998 | psnr: 21.25, ms-ssim: 0.8926

current train/eval time: 13:03:24.414949
step 80000 generator losses | train: 74.1, val: 74.48 | content: 7.086, color: 589.5, tv: 0.0009756 | psnr: 21.26, ms-ssim: 0.8938

current train/eval time: 13:29:35.878658
total train/eval time: 13:39:20.994525
