Color Adversial Images
WARNING:tensorflow:From /itet-stor/ollehman/net_scratch/conda_envs/tencu10/lib/python3.7/site-packages/tensorflow_core/python/compat/v2_compat.py:68: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term

The following parameters will be applied for CNN training:

Batch size: 28
Train size: 2000
Learning rate: 1e-05
Training iterations: 60000
Restore iteration at: 33000

Loss: dped_night
Path to DPED dataset: ../../crops/
Path to VGG-19 network: vgg_pretrained/imagenet-vgg-verydeep-19.mat
Evaluation step: 1000
Run Id: dped_night_loss_color
From_model: dped_night_loss_color
Input Images: 3

2021-06-21 10:50:05.487245: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-21 10:50:05.599061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:83:00.0
2021-06-21 10:50:05.601009: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-06-21 10:50:05.604318: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-06-21 10:50:05.607398: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-06-21 10:50:05.609228: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-06-21 10:50:05.613572: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-06-21 10:50:05.616902: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-06-21 10:50:05.624338: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-06-21 10:50:05.631632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2021-06-21 10:50:05.633119: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2021-06-21 10:50:05.659938: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2199990000 Hz
2021-06-21 10:50:05.661732: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55945385a820 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-21 10:50:05.662859: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-06-21 10:50:05.674172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:83:00.0
2021-06-21 10:50:05.675338: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-06-21 10:50:05.676441: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-06-21 10:50:05.677594: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-06-21 10:50:05.678780: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-06-21 10:50:05.679969: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-06-21 10:50:05.681042: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-06-21 10:50:05.682273: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-06-21 10:50:05.699734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2021-06-21 10:50:05.700975: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-06-21 10:50:05.931637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-21 10:50:05.933115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-06-21 10:50:05.934187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-06-21 10:50:05.954135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11437 MB memory) -> physical GPU (device: 0, name: TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
2021-06-21 10:50:05.959489: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5594546fa000 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-06-21 10:50:05.960685: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): TITAN Xp, Compute Capability 6.1
WARNING:tensorflow:From /srv/beegfs02/scratch/hdr_night/data/hdr_night/DPED_night/vgg.py:49: The name tf.nn.max_pool is deprecated. Please use tf.nn.max_pool2d instead.

WARNING:tensorflow:From /itet-stor/ollehman/net_scratch/conda_envs/tencu10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
Restoring Variables from: dped_night_loss_color/iteration_33000
Initializing variables
Loading validation data...
Validation data was loaded

Loading training data...
Training data was loaded

Training network
2021-06-21 11:00:03.653869: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-06-21 11:00:03.899469: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-06-21 11:00:05.027531: W tensorflow/stream_executor/cuda/redzone_allocator.cc:312] Not found: ./bin/ptxas not found
Relying on driver to perform ptx compilation. This message will be only logged once.
2021-06-21 11:00:06.769843: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.27GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-21 11:00:06.806005: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.19GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-21 11:00:06.942012: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.27GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-21 11:00:07.721989: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.27GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
step 34000 | discriminator accuracy | train: 0.8677, test: 0.791
step 34000 generator losses | train: 113.6, val: 100.2 | content: 10.67, color: 3158, texture: -13.73, tv: 0.001113 | psnr: 14.84, ms-ssim: 0.8086

total train/eval time: 0:27:46.567016
step 35000 | discriminator accuracy | train: 0.7981, test: 0.7379
step 35000 generator losses | train: 98.81, val: 89.58 | content: 9.94, color: 2800, texture: -16.15, tv: 0.0008487 | psnr: 15.28, ms-ssim: 0.8234

total train/eval time: 0:50:33.115068
step 36000 | discriminator accuracy | train: 0.72, test: 0.6985
step 36000 generator losses | train: 88.15, val: 85.65 | content: 9.494, color: 2573, texture: -15.52, tv: 0.001097 | psnr: 15.59, ms-ssim: 0.8216

total train/eval time: 1:13:51.982905
step 37000 | discriminator accuracy | train: 0.7236, test: 0.6019
step 37000 generator losses | train: 79.12, val: 76.52 | content: 9.116, color: 943, texture: -19.13, tv: 0.001669 | psnr: 19.55, ms-ssim: 0.865

total train/eval time: 1:37:16.044276
step 38000 | discriminator accuracy | train: 0.7744, test: 0.822
step 38000 generator losses | train: 75.01, val: 91.81 | content: 9.809, color: 1027, texture: -11.4, tv: 0.002114 | psnr: 19, ms-ssim: 0.8601

total train/eval time: 2:00:32.030010
step 39000 | discriminator accuracy | train: 0.761, test: 0.5341
step 39000 generator losses | train: 85.67, val: 71.67 | content: 9.064, color: 864.6, texture: -23.45, tv: 0.001813 | psnr: 19.87, ms-ssim: 0.8686

total train/eval time: 2:23:21.240242
step 40000 | discriminator accuracy | train: 0.8329, test: 0.5415
step 40000 generator losses | train: 76.83, val: 66.93 | content: 9.004, color: 830.2, texture: -27.47, tv: 0.001823 | psnr: 20, ms-ssim: 0.8694

total train/eval time: 2:46:28.123905
step 41000 | discriminator accuracy | train: 0.8409, test: 0.5562
step 41000 generator losses | train: 74.14, val: 66.69 | content: 9.112, color: 851.8, texture: -29.21, tv: 0.002523 | psnr: 19.73, ms-ssim: 0.863

total train/eval time: 3:12:01.060952
step 42000 | discriminator accuracy | train: 0.8665, test: 0.5709
step 42000 generator losses | train: 72.99, val: 65.82 | content: 8.914, color: 866.2, texture: -28.05, tv: 0.002478 | psnr: 19.78, ms-ssim: 0.8655

total train/eval time: 3:34:57.821043
step 43000 | discriminator accuracy | train: 0.875, test: 0.5494
step 43000 generator losses | train: 72.98, val: 62.62 | content: 8.965, color: 843.6, texture: -31.77, tv: 0.002393 | psnr: 19.84, ms-ssim: 0.8663

total train/eval time: 3:58:25.121297
step 44000 | discriminator accuracy | train: 0.8837, test: 0.5588
step 44000 generator losses | train: 65.39, val: 61.67 | content: 8.904, color: 760.9, texture: -31.88, tv: 0.002403 | psnr: 20.15, ms-ssim: 0.8657

total train/eval time: 4:21:54.493474
step 45000 | discriminator accuracy | train: 0.8985, test: 0.5462
step 45000 generator losses | train: 66.85, val: 58.47 | content: 8.93, color: 761.4, texture: -35.3, tv: 0.00256 | psnr: 20.16, ms-ssim: 0.8643

total train/eval time: 4:45:18.837458
step 46000 | discriminator accuracy | train: 0.907, test: 0.5609
step 46000 generator losses | train: 66.91, val: 60.67 | content: 8.93, color: 736.1, texture: -33.24, tv: 0.002881 | psnr: 20.19, ms-ssim: 0.8667

total train/eval time: 5:08:52.408038
step 47000 | discriminator accuracy | train: 0.9095, test: 0.5326
step 47000 generator losses | train: 61.67, val: 58.56 | content: 8.987, color: 815.3, texture: -36.38, tv: 0.00286 | psnr: 19.86, ms-ssim: 0.8637

total train/eval time: 5:32:23.518425
step 48000 | discriminator accuracy | train: 0.9153, test: 0.5446
step 48000 generator losses | train: 62.03, val: 55.95 | content: 8.873, color: 713.1, texture: -37.36, tv: 0.002885 | psnr: 20.31, ms-ssim: 0.8666

total train/eval time: 5:56:07.521572
step 49000 | discriminator accuracy | train: 0.9209, test: 0.5593
step 49000 generator losses | train: 64.21, val: 54.34 | content: 8.836, color: 756.1, texture: -38.42, tv: 0.002537 | psnr: 20.2, ms-ssim: 0.8682

total train/eval time: 6:19:32.975677
step 50000 | discriminator accuracy | train: 0.9237, test: 0.562
step 50000 generator losses | train: 59.6, val: 55.07 | content: 8.878, color: 720.7, texture: -38.18, tv: 0.002828 | psnr: 20.3, ms-ssim: 0.8663

total train/eval time: 6:43:14.521645
step 51000 | discriminator accuracy | train: 0.9251, test: 0.5746
step 51000 generator losses | train: 58.19, val: 56.43 | content: 8.942, color: 784.7, texture: -37.6, tv: 0.002688 | psnr: 20.09, ms-ssim: 0.8672

total train/eval time: 7:06:55.231742
step 52000 | discriminator accuracy | train: 0.9263, test: 0.5383
step 52000 generator losses | train: 61.25, val: 48.88 | content: 8.896, color: 843.9, texture: -44.9, tv: 0.003092 | psnr: 19.77, ms-ssim: 0.8613

total train/eval time: 7:30:52.868284
step 53000 | discriminator accuracy | train: 0.9353, test: 0.5441
step 53000 generator losses | train: 58.28, val: 52.25 | content: 8.866, color: 745.6, texture: -41.05, tv: 0.002876 | psnr: 20.13, ms-ssim: 0.8637

total train/eval time: 7:54:45.348147
step 54000 | discriminator accuracy | train: 0.9406, test: 0.5473
step 54000 generator losses | train: 55.3, val: 45.82 | content: 8.817, color: 707.6, texture: -46.74, tv: 0.002548 | psnr: 20.37, ms-ssim: 0.8718

total train/eval time: 8:18:44.831449
step 55000 | discriminator accuracy | train: 0.9344, test: 0.5378
step 55000 generator losses | train: 54.9, val: 46.73 | content: 8.876, color: 693, texture: -46.51, tv: 0.002837 | psnr: 20.39, ms-ssim: 0.8688

total train/eval time: 8:41:38.869030
step 56000 | discriminator accuracy | train: 0.9391, test: 0.5394
step 56000 generator losses | train: 55.23, val: 47.34 | content: 8.94, color: 754.5, texture: -46.81, tv: 0.00321 | psnr: 20.07, ms-ssim: 0.8625

total train/eval time: 9:04:46.382739
step 57000 | discriminator accuracy | train: 0.9468, test: 0.5478
step 57000 generator losses | train: 58.79, val: 48.99 | content: 8.861, color: 728, texture: -44.25, tv: 0.002953 | psnr: 20.16, ms-ssim: 0.8657

total train/eval time: 9:28:53.490980
step 58000 | discriminator accuracy | train: 0.9445, test: 0.5326
step 58000 generator losses | train: 56.74, val: 45.65 | content: 8.904, color: 743.3, texture: -48.02, tv: 0.003038 | psnr: 20.13, ms-ssim: 0.8661

total train/eval time: 9:51:47.382236
step 59000 | discriminator accuracy | train: 0.9473, test: 0.5305
step 59000 generator losses | train: 55.1, val: 45.44 | content: 8.849, color: 680.9, texture: -47.45, tv: 0.002777 | psnr: 20.43, ms-ssim: 0.8715

total train/eval time: 10:15:15.328183
step 60000 | discriminator accuracy | train: 0.9475, test: 0.5378
step 60000 generator losses | train: 55.34, val: 43.14 | content: 8.811, color: 769.7, texture: -49.7, tv: 0.003033 | psnr: 20.04, ms-ssim: 0.8641

total train/eval time: 10:38:56.426707
total train/eval time: 10:45:26.626846
All Done
