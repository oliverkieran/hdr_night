Gray Adversial Images
WARNING:tensorflow:From /itet-stor/ollehman/net_scratch/conda_envs/tencu10/lib/python3.7/site-packages/tensorflow_core/python/compat/v2_compat.py:68: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term

The following parameters will be applied for CNN training:

Batch size: 28
Train size: 2000
Learning rate: 5e-05
Training iterations: 35000
Restore iteration at: 20000

Loss: dped_night
Path to DPED dataset: ../../crops/
Path to VGG-19 network: vgg_pretrained/imagenet-vgg-verydeep-19.mat
Evaluation step: 1000
Run Id: dped_night_loss_gray
Input Images: 3

2021-06-20 10:39:48.540168: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-20 10:39:48.629666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:84:00.0
2021-06-20 10:39:48.631422: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-06-20 10:39:48.634561: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-06-20 10:39:48.637444: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-06-20 10:39:48.638951: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-06-20 10:39:48.642229: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-06-20 10:39:48.644986: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-06-20 10:39:48.651203: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-06-20 10:39:48.661921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2021-06-20 10:39:48.663287: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2021-06-20 10:39:48.694635: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099875000 Hz
2021-06-20 10:39:48.698486: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563f068e14a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-20 10:39:48.700182: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-06-20 10:39:48.709937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:84:00.0
2021-06-20 10:39:48.710874: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-06-20 10:39:48.711738: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-06-20 10:39:48.712556: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-06-20 10:39:48.713446: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-06-20 10:39:48.714290: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-06-20 10:39:48.715387: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-06-20 10:39:48.716332: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-06-20 10:39:48.729341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2021-06-20 10:39:48.730379: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-06-20 10:39:48.998198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-20 10:39:48.999390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-06-20 10:39:49.000436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-06-20 10:39:49.013420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10479 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:84:00.0, compute capability: 6.1)
2021-06-20 10:39:49.017303: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563f076b20f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-06-20 10:39:49.018999: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
WARNING:tensorflow:From /srv/beegfs02/scratch/hdr_night/data/hdr_night/DPED_night/vgg.py:49: The name tf.nn.max_pool is deprecated. Please use tf.nn.max_pool2d instead.

WARNING:tensorflow:From /itet-stor/ollehman/net_scratch/conda_envs/tencu10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
Restoring Variables from: dped_night_loss/iteration_20000
Initializing variables
Loading validation data...
Validation data was loaded

Loading training data...
Training data was loaded

Training network
2021-06-20 10:46:47.869148: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-06-20 10:46:48.149812: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-06-20 10:46:49.448292: W tensorflow/stream_executor/cuda/redzone_allocator.cc:312] Not found: ./bin/ptxas not found
Relying on driver to perform ptx compilation. This message will be only logged once.
2021-06-20 10:46:49.753347: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.91GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-20 10:46:50.636568: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.98GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-20 10:46:50.694474: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.14GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-20 10:46:51.253346: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 520.00MiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-20 10:46:51.295258: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 324.00MiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-20 10:46:51.297607: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 324.00MiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-20 10:46:51.338973: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 324.00MiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-20 10:46:51.424470: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.27GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-20 10:46:51.455183: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.19GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-20 10:46:51.601254: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.27GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
step 21000 | discriminator accuracy | train: 0.683, test: 0.6124
step 21000 generator losses | train: 105.8, val: 80.45 | content: 9.373, color: 1511, texture: -18.35, tv: 0.0007227 | psnr: 17.62, ms-ssim: 0.8468

total train/eval time: 0:26:24.145757
step 22000 | discriminator accuracy | train: 0.5791, test: 0.5394
step 22000 generator losses | train: 75.9, val: 69.21 | content: 8.521, color: 718.4, texture: -19.59, tv: 0.001041 | psnr: 20.67, ms-ssim: 0.8826

total train/eval time: 0:48:59.253137
step 23000 | discriminator accuracy | train: 0.5883, test: 0.511
step 23000 generator losses | train: 68.59, val: 68.22 | content: 8.511, color: 682.7, texture: -20.59, tv: 0.001532 | psnr: 20.7, ms-ssim: 0.8766

total train/eval time: 1:11:16.522040
step 24000 | discriminator accuracy | train: 0.6385, test: 0.4968
step 24000 generator losses | train: 65.9, val: 63.67 | content: 8.267, color: 617.2, texture: -22.79, tv: 0.001669 | psnr: 21.05, ms-ssim: 0.8825

total train/eval time: 1:33:52.358778
step 25000 | discriminator accuracy | train: 0.6951, test: 0.5037
step 25000 generator losses | train: 61.81, val: 58.77 | content: 8.164, color: 821.8, texture: -27.48, tv: 0.001739 | psnr: 20, ms-ssim: 0.8754

total train/eval time: 1:56:27.216374
step 26000 | discriminator accuracy | train: 0.7562, test: 0.4942
step 26000 generator losses | train: 62.57, val: 54.86 | content: 8.335, color: 599.7, texture: -32.59, tv: 0.002174 | psnr: 20.94, ms-ssim: 0.8769

total train/eval time: 2:19:09.596179
step 27000 | discriminator accuracy | train: 0.788, test: 0.4911
step 27000 generator losses | train: 61.43, val: 52.69 | content: 8.786, color: 712, texture: -39.71, tv: 0.002308 | psnr: 20.39, ms-ssim: 0.8739

total train/eval time: 2:41:45.358068
step 28000 | discriminator accuracy | train: 0.8158, test: 0.5289
step 28000 generator losses | train: 58.61, val: 48.92 | content: 8.312, color: 607.3, texture: -38.67, tv: 0.002386 | psnr: 20.92, ms-ssim: 0.8756

total train/eval time: 3:03:53.269951
step 29000 | discriminator accuracy | train: 0.8408, test: 0.541
step 29000 generator losses | train: 59.3, val: 44.84 | content: 8.091, color: 668.5, texture: -40.18, tv: 0.002465 | psnr: 20.61, ms-ssim: 0.8771

total train/eval time: 3:26:13.670512
step 30000 | discriminator accuracy | train: 0.8503, test: 0.5079
step 30000 generator losses | train: 58.52, val: 45.94 | content: 8.44, color: 657, texture: -43.14, tv: 0.002574 | psnr: 20.62, ms-ssim: 0.8728

total train/eval time: 3:48:48.447783
step 31000 | discriminator accuracy | train: 0.8472, test: 0.5483
step 31000 generator losses | train: 52.52, val: 49.17 | content: 8.361, color: 609.7, texture: -38.75, tv: 0.00254 | psnr: 20.79, ms-ssim: 0.8716

total train/eval time: 4:11:08.524392
step 32000 | discriminator accuracy | train: 0.8726, test: 0.5452
step 32000 generator losses | train: 54.22, val: 50.54 | content: 8.59, color: 579.8, texture: -39.87, tv: 0.002885 | psnr: 20.8, ms-ssim: 0.8633

total train/eval time: 4:33:29.823131
step 33000 | discriminator accuracy | train: 0.8752, test: 0.5383
step 33000 generator losses | train: 54.13, val: 42.99 | content: 8.068, color: 605.8, texture: -41.74, tv: 0.001885 | psnr: 21.03, ms-ssim: 0.8792

total train/eval time: 4:56:08.907642
step 34000 | discriminator accuracy | train: 0.8856, test: 0.5467
step 34000 generator losses | train: 52.07, val: 40.54 | content: 8.02, color: 589.3, texture: -43.65, tv: 0.00199 | psnr: 21.11, ms-ssim: 0.882

total train/eval time: 5:18:42.717848
step 35000 | discriminator accuracy | train: 0.8871, test: 0.5336
step 35000 generator losses | train: 52.42, val: 43.32 | content: 8.227, color: 598.1, texture: -43.58, tv: 0.002227 | psnr: 20.96, ms-ssim: 0.8775

total train/eval time: 5:41:01.126136
total train/eval time: 5:44:09.811389
All Done
