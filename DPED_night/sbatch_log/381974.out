WARNING:tensorflow:From /itet-stor/ollehman/net_scratch/conda_envs/tencu10/lib/python3.7/site-packages/tensorflow_core/python/compat/v2_compat.py:68: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term

The following parameters will be applied for CNN training:

Batch size: 28
Train size: 2000
Learning rate: 5e-05
Training iterations: 30000
Restore iteration at: 20000

Loss: dped_night
Path to DPED dataset: ../../crops/
Path to VGG-19 network: vgg_pretrained/imagenet-vgg-verydeep-19.mat
Evaluation step: 1000
Run Id: dped_night_loss
Input Images: 3

2021-06-19 15:22:59.188943: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-06-19 15:22:59.258452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:84:00.0
2021-06-19 15:22:59.261133: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-06-19 15:22:59.265223: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-06-19 15:22:59.268985: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-06-19 15:22:59.271565: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-06-19 15:22:59.276115: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-06-19 15:22:59.280125: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-06-19 15:22:59.288030: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-06-19 15:22:59.295607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2021-06-19 15:22:59.297206: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2021-06-19 15:22:59.324155: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2199920000 Hz
2021-06-19 15:22:59.325798: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d397db41f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-19 15:22:59.327130: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-06-19 15:22:59.334676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:84:00.0
2021-06-19 15:22:59.336036: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-06-19 15:22:59.337539: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-06-19 15:22:59.338734: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-06-19 15:22:59.340027: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-06-19 15:22:59.341293: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-06-19 15:22:59.342558: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-06-19 15:22:59.343726: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-06-19 15:22:59.353699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2021-06-19 15:22:59.355093: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-06-19 15:22:59.566235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-19 15:22:59.567473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2021-06-19 15:22:59.568630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2021-06-19 15:22:59.587318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11437 MB memory) -> physical GPU (device: 0, name: TITAN Xp, pci bus id: 0000:84:00.0, compute capability: 6.1)
2021-06-19 15:22:59.591648: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d398b80ce0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-06-19 15:22:59.592867: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): TITAN Xp, Compute Capability 6.1
WARNING:tensorflow:From /srv/beegfs02/scratch/hdr_night/data/hdr_night/DPED_night/vgg.py:49: The name tf.nn.max_pool is deprecated. Please use tf.nn.max_pool2d instead.

WARNING:tensorflow:From /itet-stor/ollehman/net_scratch/conda_envs/tencu10/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1375: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
Restoring Variables from: dped_night_loss/iteration_20000
Initializing variables
Loading validation data...
Validation data was loaded

Loading training data...
Training data was loaded

Training network
2021-06-19 15:32:23.845901: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-06-19 15:32:24.094691: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-06-19 15:32:25.324432: W tensorflow/stream_executor/cuda/redzone_allocator.cc:312] Not found: ./bin/ptxas not found
Relying on driver to perform ptx compilation. This message will be only logged once.
2021-06-19 15:32:26.448035: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.98GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-19 15:32:27.014041: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.31GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-19 15:32:27.100523: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.31GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-19 15:32:27.137489: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.27GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-19 15:32:27.160752: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.19GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-19 15:32:27.186309: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.35GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-19 15:32:27.317624: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.27GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-19 15:32:27.318986: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.19GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-19 15:32:27.405288: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.31GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-06-19 15:32:28.093247: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.27GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
step 21000 | discriminator accuracy | train: 0.754, test: 0.5089
step 21000 generator losses | train: 116.7, val: 88.35 | content: 10.28, color: 2214, texture: -20.57, tv: 0.0005947 | psnr: 16.2, ms-ssim: 0.8208

total train/eval time: 0:27:20.697442
step 22000 | discriminator accuracy | train: 0.5914, test: 0.5751
step 22000 generator losses | train: 82.08, val: 72.27 | content: 8.755, color: 740.9, texture: -19.03, tv: 0.000826 | psnr: 20.46, ms-ssim: 0.875

total train/eval time: 0:49:38.919546
step 23000 | discriminator accuracy | train: 0.5727, test: 0.5226
step 23000 generator losses | train: 70.55, val: 67.98 | content: 8.42, color: 640.7, texture: -19.75, tv: 0.001128 | psnr: 21.02, ms-ssim: 0.8852

total train/eval time: 1:11:49.413318
step 24000 | discriminator accuracy | train: 0.5899, test: 0.5263
step 24000 generator losses | train: 66.7, val: 65.98 | content: 8.267, color: 631.9, texture: -20.19, tv: 0.00125 | psnr: 21.08, ms-ssim: 0.8858

total train/eval time: 1:34:09.149705
step 25000 | discriminator accuracy | train: 0.6071, test: 0.5131
step 25000 generator losses | train: 62.84, val: 64.25 | content: 8.193, color: 612.7, texture: -21.22, tv: 0.001478 | psnr: 21.13, ms-ssim: 0.8853

total train/eval time: 1:56:13.114812
step 26000 | discriminator accuracy | train: 0.6506, test: 0.5095
step 26000 generator losses | train: 63.78, val: 60.53 | content: 8.029, color: 626.1, texture: -23.56, tv: 0.001657 | psnr: 21.01, ms-ssim: 0.887

total train/eval time: 2:18:25.705059
step 27000 | discriminator accuracy | train: 0.6883, test: 0.4701
step 27000 generator losses | train: 62.05, val: 55.27 | content: 8.089, color: 596.7, texture: -29.48, tv: 0.002009 | psnr: 21.09, ms-ssim: 0.883

total train/eval time: 2:40:48.653418
step 28000 | discriminator accuracy | train: 0.7355, test: 0.4947
step 28000 generator losses | train: 59.21, val: 56.48 | content: 8.2, color: 710.5, texture: -29.51, tv: 0.001592 | psnr: 20.61, ms-ssim: 0.8769

total train/eval time: 3:03:15.606210
step 29000 | discriminator accuracy | train: 0.7798, test: 0.5121
step 29000 generator losses | train: 60.31, val: 51.16 | content: 7.996, color: 608.1, texture: -32.66, tv: 0.001977 | psnr: 20.98, ms-ssim: 0.8842

total train/eval time: 3:25:50.307672
step 30000 | discriminator accuracy | train: 0.7983, test: 0.51
step 30000 generator losses | train: 59.06, val: 45.96 | content: 7.879, color: 580.5, texture: -36.64, tv: 0.001826 | psnr: 21.19, ms-ssim: 0.8865

total train/eval time: 3:48:13.523363
total train/eval time: 3:52:46.378555
